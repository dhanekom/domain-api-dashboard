{{ block "dashboard" . }}
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="/public/css/styles.css">
  <script src="/public/javascript/htmx.min.js"></script>
  <title>Domain-API Dashboard</title>
</head>
<body class="bg-gray-100 text-gray-900">
  <div>
    <div class="m-auto w-full">
      <nav class="bg-white flex flex-row items-center">
        <div id="logo" class="p-4">
          <img src="/public/img/xneelo-log.webp" alt="" class="w-full object-cover">
        </div>
      </nav>
    </div>

    <main class="m-4 max-w-screen-lg mx-auto">
      <div class="flex items-center">
        <label class="w-1/6 text-right" for="search">Search:</label>
        <input
          type="search"
          id="search"
          name="search"
          class="w-5/6 ml-2 p-2 text-sm text-gray-900 border border-gray-300 rounded-lg bg-gray-50 focus:ring-gray-500 focus:border-gray-500" placeholder="Enter Domain name..."
          hx-post="/search"  
          hx-target="#search-results"
          hx-trigger="input changed delay:500ms, search"
          hx-indicator="#loading"
        >
      </div>

      <div class="relative overflow-x-auto rounded mt-4">
          <table class="w-full text-sm text-left rtl:text-right">
              <thead class="text-xs text-gray-700 uppercase bg-gray-50">
                  <tr>
                      <th scope="col" class="px-6 py-3">
                          Domain Name
                      </th>
                      <th scope="col" class="px-6 py-3">
                          Account No
                      </th>
                      <th scope="col" class="px-6 py-3">
                          Client No
                      </th>
                      <th scope="col" class="px-6 py-3 text-center">
                          Bill for Reg
                      </th>
                      <th scope="col" class="px-6 py-3">
                          Status
                      </th>
                      <th scope="col" class="px-6 py-3">
                          Active
                      </th>
                  </tr>
              </thead>
              <tbody id="search-results">

              </tbody>
          </table>

          <span id="loading" class="htmx-indicator">
            <img src="/public/img/loading.gif" alt="loading..." class="mt-2 m-auto h-10">
          </span>
      </div>
    </main>
  </div>

  <script>
    document.body.addEventListener('htmx:beforeRequest', function(evt){
      const search = document.getElementById("search");
      if (search.value == "") {
        // evt.preventDefault() cancels the request
        evt.preventDefault();
        return
      }
    });
  </script>
</body>
</html>
{{ end }}

{{ block "dashboard-search-result" .}}
  {{ range .Domains }}
  <tr class="bg-white border-b">
    <th scope="row" class="px-6 py-4 font-medium whitespace-nowrap">
        {{ .DomainName }}
    </th>
    <td class="px-6 py-4">
       {{ .AccountNo }} 
    </td>
    <td class="px-6 py-4">
        {{ .ClientNo }}
    </td>
    <td class="px-6 py-4 text-center">
        {{ .BillForReg }}
    </td>
    <td class="px-6 py-4">
      {{ .Status }}
    </td>
    <td class="px-6 py-4">
      {{ if .Active }}
      <span class="inline-flex items-center rounded-md bg-green-50 px-2 py-1 text-xs font-medium text-green-700 ring-1 ring-inset ring-green-600/20">Active</span>
      {{ else }}
      <span class="inline-flex items-center rounded-md bg-red-50 px-2 py-1 text-xs font-medium text-red-700 ring-1 ring-inset ring-red-600/10">Inactive</span>
      {{ end }}
    </td>
  </tr>
  {{ end }}
{{ end }}